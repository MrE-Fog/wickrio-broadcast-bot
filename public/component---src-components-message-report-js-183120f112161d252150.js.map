{"version":3,"sources":["webpack:///./src/components/message/report.js"],"names":["Report","id","useContext","MessageContext","report","sendReportStatus","secGroups","useState","page","setPage","size","useEffect","date","Date","broadcast","when_sent","style","className","message","toLocaleDateString","toLocaleTimeString","target","display","margin","Math","max","summary","sent","failed","pending","ack","justifyContent","alignContent","alignItems","marginTop","overflow","bgcolor","map","user","idx","status","key","status_message","includes","href","rel","fontSize","fontFamily","letterSpacing","textAlign","color","lineHeight","sent_datetime","read_datetime","length","onClick","getLastReportPage","getNextReportPage"],"mappings":"uKAqOeA,UAjOA,SAAC,GAAY,IAAD,MAATC,EAAS,EAATA,GAAS,EACuBC,qBAAWC,KAAnDC,EADiB,EACjBA,OAAmBC,GADF,EACTC,UADS,EACED,kBADF,EAEDE,mBAAS,GAA1BC,EAFkB,KAEZC,EAFY,OAGDF,mBAAS,IAA1BG,EAHkB,UAMzBC,qBAAU,WAGRN,EAAiBJ,EAAI,EAAG,MACvB,IAGH,IAAMW,EAAO,IAAIC,KAAKT,SAAT,UAASA,EAAQU,iBAAjB,aAAS,EAAmBC,WAgBzC,OACE,oCACGX,EAAOU,UACN,oCACE,wBAAIE,MAAO,GAKTC,UAAU,gBAAgBb,EAAOU,UAAUI,SAE7C,uBAAGD,UAAU,mBAAb,WAA2CL,EAAKO,qBAAhD,OAA2EP,EAAKQ,qBAAhF,OAA2GhB,EAAOU,UAAUO,QAC5H,yBAAKL,MAAO,CACVM,QAAS,OACTC,OAAQ,WAGR,yBAAKP,MAAO,CACVO,OAAQ,iBAER,wBACEN,UAAU,aACVD,MAAO,CAAEO,OAAQ,IAChBC,KAAKC,IAAI,EAAGrB,EAAOU,UAAUY,QAAQC,KAAOvB,EAAOU,UAAUY,QAAQE,SAExE,uBAAGX,UAAU,UACXD,MAAO,CAAEO,OAAQ,IADnB,aAKF,yBAAKP,MAAO,CACVO,OAAQ,WAER,wBAAIN,UAAU,aACZD,MAAO,CAAEO,OAAQ,IAChBnB,EAAOU,UAAUY,QAAQG,SAE5B,uBAAGZ,UAAU,UACXD,MAAO,CAAEO,OAAQ,IADnB,YAKF,yBAAKP,MAAO,CACVO,OAAQ,WAER,wBAAIN,UAAU,aACZD,MAAO,CAAEO,OAAQ,IAChBnB,EAAOU,UAAUY,QAAQE,QAE5B,uBAAGX,UAAU,UACXD,MAAO,CAAEO,OAAQ,IADnB,WAKF,yBAAKP,MAAO,CACVO,OAAQ,WAER,wBAAIN,UAAU,aACZD,MAAO,CAAEO,OAAQ,IADnB,UAEGnB,EAAOU,UAAUY,eAFpB,aAEG,EAA0BI,KAE7B,uBAAGb,UAAU,UACXD,MAAO,CAAEO,OAAQ,IADnB,kBAMJ,yBAAKP,MAAO,CAAEM,QAAS,OAAQS,eAAgB,gBAAiBC,aAAc,SAAUC,WAAY,WAClG,6BACE,wBAAIhB,UAAU,sBAAd,UACA,uBAAGA,UAAU,mBAAb,gBAEF,4BAAQA,UAAU,kBAAlB,aAEF,6BACEA,UAAU,cACVD,MAAO,CACLkB,UAAW,OACXC,SAAU,WAGZ,+BACE,2BAAOC,QAAQ,SACb,4BACE,wBAAInB,UAAU,QAAd,UACA,wBAAIA,UAAU,UAAd,QACA,wBAAIA,UAAU,UAAd,WACA,wBAAIA,UAAU,UAAd,QACA,wBAAIA,UAAU,UAAd,UAGJ,yCACGb,EAAOU,UAAUV,cADpB,aACG,EAAyBiC,KAAI,SAACC,EAAMC,GAAS,IAAD,EAO3C,OANmB,GAAfD,EAAKE,OAAeF,EAAKE,OAAS,UACd,GAAfF,EAAKE,OAAeF,EAAKE,OAAS,OACnB,GAAfF,EAAKE,OAAeF,EAAKE,OAAS,SACnB,GAAfF,EAAKE,OAAeF,EAAKE,OAAS,MACnB,GAAfF,EAAKE,SAAeF,EAAKE,OAAS,WAGzC,wBAAIC,IAAKF,GACP,4BACE,uBAAGtB,UAAU,qBACVqB,EAAKE,SAGV,wBAAIvB,UAAU,cAAcqB,EAAKA,OAChCA,SAAA,UAAAA,EAAMI,sBAAN,eAAsBC,SAAS,SAC9B,wBAAI1B,UAAU,cACZ,uBAAG2B,KAAMN,EAAKI,eAAgBG,IAAI,sBAAsBxB,OAAO,UAA/D,aAKF,wBAAIJ,UAAU,cACXqB,EAAKI,gBAIV,wBAAIzB,UAAU,cAAa,6BACzB,uBAAGD,MAAO,CACR8B,SAAU,GACVC,WAAY,YACZC,cAAe,SACfC,UAAW,QACXC,MAAO,oBACPC,WAAY,OAEX,IAAItC,KAAKyB,EAAKc,eAAejC,sBAGhC,uBAAGH,MAAO,CACR8B,SAAU,GACVC,WAAY,YACZC,cAAe,SACfC,UAAW,QACXC,MAAO,oBACPC,WAAY,OAEX,IAAItC,KAAKyB,EAAKc,eAAehC,wBAGlC,wBAAIH,UAAU,cAAa,6BACzB,uBAAGD,MAAO,CACR8B,SAAU,GACVC,WAAY,YACZC,cAAe,SACfC,UAAW,QACXC,MAAO,oBACPC,WAAY,OAEX,IAAItC,KAAKyB,EAAKe,eAAelC,sBAGhC,uBAAGH,MAAO,CACR8B,SAAU,GACVC,WAAY,YACZC,cAAe,SACfC,UAAW,QACXC,MAAO,oBACPC,WAAY,OAEX,IAAItC,KAAKyB,EAAKe,eAAejC,8BAS3ChB,EAAOU,UAAUV,OAAOkD,OAAS,GAChC,oCACE,uBACEC,QAAS,kBArLC,SAACtD,EAAIO,EAAME,GACtB,IAATF,IACFC,EAAQD,EAAO,GACfH,EAAiBJ,EAAIO,EAAME,IAkLA8C,CAAkBhD,EAAME,KAEtC,KAEH,4BAAa,GAARF,EAAY,EAAIA,GAAQE,EAAO,GAApC,KAAkD,GAARF,EAAY,EAAIA,GAAQE,GAClE,uBACE6C,QAAS,kBAhMC,SAACtD,EAAIO,EAAME,GAEnCL,EAAiBJ,EAAIO,EAAME,GA8LE+C,CAAkBjD,EAAME,KAEtC,QAMT","file":"component---src-components-message-report-js-183120f112161d252150.js","sourcesContent":["import React, { useState, useContext, useEffect } from \"react\"\nimport { Link } from \"gatsby\"\nimport { MessageContext } from \"../context\"\n\nconst Report = ({ id }) => {\n  const { report, secGroups, sendReportStatus } = useContext(MessageContext)\n  const [page, setPage] = useState(0)\n  const [size, setSize] = useState(25)\n\n\n  useEffect(() => {\n\n    // no way to get accumulated number of records \n    sendReportStatus(id, 0, 25)\n  }, [])\n\n  // const broadcast = sentBroadcasts.find(broadcast => broadcast.message_id === id)\n  const date = new Date(report?.broadcast?.when_sent)\n  // console.log({ secGroups, report, date })\n  // console.log(report.broadcast.summary)\n\n  const getNextReportPage = (id, page, size) => {\n    // setPage(page + 1)\n    sendReportStatus(id, page, size)\n  }\n\n  const getLastReportPage = (id, page, size) => {\n    if (page !== 0) {\n      setPage(page - 1)\n      sendReportStatus(id, page, size)\n    }\n  }\n\n  return (\n    <>\n      {report.broadcast ?\n        <>\n          <h3 style={{\n            // marginTop: '40px',\n            // overflow: 'scroll'\n\n          }}\n            className=\"title-report\">{report.broadcast.message}\n          </h3>\n          <p className=\"subtitle-report\">{`Sent on ${date.toLocaleDateString()} at ${date.toLocaleTimeString()} to ${report.broadcast.target}`}</p>\n          <div style={{\n            display: 'flex',\n            margin: '25px 0'\n\n          }}>\n            <div style={{\n              margin: '0px 15px 0 0'\n            }}>\n              <h2\n                className=\"summaryVal\"\n                style={{ margin: 0 }}>\n                {Math.max(0, report.broadcast.summary.sent - report.broadcast.summary.failed)}\n              </h2>\n              <p className=\"summary\"\n                style={{ margin: 0 }}>\n                received\n              </p>\n            </div>\n            <div style={{\n              margin: '0 15px'\n            }}>\n              <h2 className=\"summaryVal\"\n                style={{ margin: 0 }}>\n                {report.broadcast.summary.pending}\n              </h2>\n              <p className=\"summary\"\n                style={{ margin: 0 }}>\n                pending\n              </p>\n            </div>\n            <div style={{\n              margin: '0 15px'\n            }}>\n              <h2 className=\"summaryVal\"\n                style={{ margin: 0 }}>\n                {report.broadcast.summary.failed}\n              </h2>\n              <p className=\"summary\"\n                style={{ margin: 0 }}>\n                failed\n             </p>\n            </div>\n            <div style={{\n              margin: '0 15px'\n            }}>\n              <h2 className=\"summaryVal\"\n                style={{ margin: 0 }}>\n                {report.broadcast.summary?.ack}\n              </h2>\n              <p className=\"summary\"\n                style={{ margin: 0 }}>\n                acknowledged\n              </p>\n            </div>\n          </div>\n          <div style={{ display: 'flex', justifyContent: 'space-between', alignContent: 'center', alignItems: 'center' }}>\n            <div>\n              <h2 className=\"report-table-title\">Report</h2>\n              <p className=\"subtitle-report\">Lorem Ipsum</p>\n            </div>\n            <button className=\"downloadButton\">Download</button>\n          </div>\n          <section\n            className=\"sentsection\"\n            style={{\n              marginTop: '20px',\n              overflow: 'scroll'\n            }}\n          >\n            <table >\n              <thead bgcolor=\"white\">\n                <tr>\n                  <th className=\"Date\">Status</th>\n                  <th className=\"tlabel\">Name</th>\n                  <th className=\"tlabel\">Message</th>\n                  <th className=\"tlabel\">Sent</th>\n                  <th className=\"tlabel\">Read</th>\n                </tr>\n              </thead>\n              <tbody>\n                {report.broadcast.report?.map((user, idx) => {\n                  if (user.status == 0) { user.status = \"pending\" }\n                  else if (user.status == 1) { user.status = \"sent\" }\n                  else if (user.status == 2) { user.status = \"failed\" }\n                  else if (user.status == 3) { user.status = \"ack\" }\n                  else if (user.status == 4) { user.status = \"ignored\" }\n\n                  return (\n                    <tr key={idx}>\n                      <td>\n                        <p className=\"sentmessagereport\">\n                          {user.status}\n                        </p>\n                      </td>\n                      <td className=\"trowreport\">{user.user}</td>\n                      {user?.status_message?.includes('http') ?\n                        <td className=\"trowreport\">\n                          <a href={user.status_message} rel=\"noopener noreferrer\" target=\"_blank\">\n                            Location\n                          </a>\n                        </td>\n                        :\n                        <td className=\"trowreport\">\n                          {user.status_message}\n                        </td>\n\n                      }\n                      <td className=\"trowreport\"><div>\n                        <p style={{\n                          fontSize: 12,\n                          fontFamily: 'Open Sans',\n                          letterSpacing: '0.41px',\n                          textAlign: 'right',\n                          color: 'var(--text-light)',\n                          lineHeight: 1.33\n                        }}>\n                          {new Date(user.sent_datetime).toLocaleDateString()}\n                        </p>\n\n                        <p style={{\n                          fontSize: 12,\n                          fontFamily: 'Open Sans',\n                          letterSpacing: '0.41px',\n                          textAlign: 'right',\n                          color: 'var(--text-light)',\n                          lineHeight: 1.33\n                        }}>\n                          {new Date(user.sent_datetime).toLocaleTimeString()}\n                        </p>\n                      </div></td>\n                      <td className=\"trowreport\"><div>\n                        <p style={{\n                          fontSize: 12,\n                          fontFamily: 'Open Sans',\n                          letterSpacing: '0.41px',\n                          textAlign: 'right',\n                          color: 'var(--text-light)',\n                          lineHeight: 1.33\n                        }}>\n                          {new Date(user.read_datetime).toLocaleDateString()}\n                        </p>\n\n                        <p style={{\n                          fontSize: 12,\n                          fontFamily: 'Open Sans',\n                          letterSpacing: '0.41px',\n                          textAlign: 'right',\n                          color: 'var(--text-light)',\n                          lineHeight: 1.33\n                        }}>\n                          {new Date(user.read_datetime).toLocaleTimeString()}\n                        </p>\n                      </div></td>\n                    </tr>\n                  )\n                })}\n              </tbody>\n\n            </table>\n            {report.broadcast.report.length > 1 &&\n              <>\n                <p\n                  onClick={() => getLastReportPage(page, size)}\n                >\n                  {'<'}\n                </p>\n                <p>{(page == 0 ? 1 : page) * size - 24}-{(page == 0 ? 1 : page) * size}</p>\n                <p\n                  onClick={() => getNextReportPage(page, size)}\n                >\n                  {'>'}\n                </p>\n              </>\n            }\n          </section>\n        </>\n        : 'loading'\n      }\n\n    </>\n\n  )\n}\n\nexport default Report"],"sourceRoot":""}