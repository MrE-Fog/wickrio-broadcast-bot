{"version":3,"sources":["webpack:///./src/components/message/report.js","webpack:///./src/pages/messages/report.js"],"names":["Report","id","useContext","MessageContext","report","secGroups","sendReportStatus","downloadReport","useState","page","setPage","size","console","log","useEffect","secGroup","find","group","broadcast","target","name","date","Date","when_sent","style","className","message","toLocaleDateString","toLocaleTimeString","display","margin","Math","max","summary","sent","failed","pending","ack","justifyContent","alignContent","alignItems","onClick","message_id","marginTop","overflow","bgcolor","map","user","idx","status","key","status_message","includes","href","rel","fontSize","fontFamily","letterSpacing","textAlign","color","lineHeight","sent_datetime","read_datetime","length","getLastReportPage","getNextReportPage"],"mappings":"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","file":"component---src-pages-messages-report-js-1992fa58e313b643206e.js","sourcesContent":["import React, { useState, useContext, useEffect } from \"react\"\nimport { Link } from \"gatsby\"\nimport { MessageContext } from \"../context\"\n\nconst Report = ({ id }) => {\n  const { report, secGroups, sendReportStatus, downloadReport } = useContext(MessageContext)\n  const [page, setPage] = useState(0)\n  const [size, setSize] = useState(25)\n\n  console.log({ id })\n\n  useEffect(() => {\n\n    // no way to get accumulated number of records \n    sendReportStatus(id, 0, 25)\n  }, [])\n\n  // const broadcast = sentBroadcasts.find(broadcast => broadcast.message_id === id)\n  const secGroup = secGroups.find(group => group.id === report?.broadcast?.target) || { name: 'network' }\n  const date = new Date(report?.broadcast?.when_sent)\n  // console.log({ secGroups, report, date })\n  // console.log(report.broadcast.summary)\n\n  const getNextReportPage = (id, page, size) => {\n    // setPage(page + 1)\n    sendReportStatus(id, page, size)\n  }\n\n  const getLastReportPage = (id, page, size) => {\n    if (page !== 0) {\n      setPage(page - 1)\n      sendReportStatus(id, page, size)\n    }\n  }\n\n\n  return (\n    <>\n      {report.broadcast ?\n        <>\n          <h3 style={{\n            // marginTop: '40px',\n            // overflow: 'scroll'\n\n          }}\n            className=\"title-report\">{report.broadcast.message}\n          </h3>\n          <p className=\"subtitle-report\">{`Sent on ${date.toLocaleDateString()} at ${date.toLocaleTimeString()} to ${secGroup.name}`}</p>\n          <div style={{\n            display: 'flex',\n            margin: '25px 0'\n\n          }}>\n            <div style={{\n              margin: '0px 15px 0 0'\n            }}>\n              <h2\n                className=\"summaryVal\"\n                style={{ margin: 0 }}>\n                {Math.max(0, report.broadcast.summary.sent - report.broadcast.summary.failed)}\n              </h2>\n              <p className=\"summary\"\n                style={{ margin: 0 }}>\n                recieved\n              </p>\n            </div>\n            <div style={{\n              margin: '0 15px'\n            }}>\n              <h2 className=\"summaryVal\"\n                style={{ margin: 0 }}>\n                {report.broadcast.summary.pending}\n              </h2>\n              <p className=\"summary\"\n                style={{ margin: 0 }}>\n                pending\n              </p>\n            </div>\n            <div style={{\n              margin: '0 15px'\n            }}>\n              <h2 className=\"summaryVal\"\n                style={{ margin: 0 }}>\n                {report.broadcast.summary.failed}\n              </h2>\n              <p className=\"summary\"\n                style={{ margin: 0 }}>\n                failed\n             </p>\n            </div>\n            <div style={{\n              margin: '0 15px'\n            }}>\n              <h2 className=\"summaryVal\"\n                style={{ margin: 0 }}>\n                {report.broadcast.summary?.ack}\n              </h2>\n              <p className=\"summary\"\n                style={{ margin: 0 }}>\n                acknowledged\n              </p>\n            </div>\n          </div>\n          <div style={{ display: 'flex', justifyContent: 'space-between', alignContent: 'center', alignItems: 'center' }}>\n            <div>\n              <h2 className=\"report-table-title\">Report</h2>\n              {/* <p className=\"subtitle-report\">Lorem Ipsum</p> */}\n            </div>\n            <button className=\"downloadButton\" onClick={() => downloadReport(report.broadcast.message_id, 0, 25)}>Download</button>\n          </div>\n          <section\n            className=\"sentsection\"\n            style={{\n              marginTop: '20px',\n              overflow: 'scroll'\n            }}\n          >\n            <table >\n              <thead bgcolor=\"white\">\n                <tr>\n                  <th className=\"Date\">Status</th>\n                  <th className=\"tlabel\">Name</th>\n                  <th className=\"tlabel\">Message</th>\n                  <th className=\"tlabel\">Sent</th>\n                  <th className=\"tlabel\">Read</th>\n                </tr>\n              </thead>\n              <tbody>\n                {report.broadcast.report?.map((user, idx) => {\n                  if (user.status == 0) { user.status = \"pending\" }\n                  else if (user.status == 1) { user.status = \"sent\" }\n                  else if (user.status == 2) { user.status = \"failed\" }\n                  else if (user.status == 3) { user.status = \"ack\" }\n                  else if (user.status == 4) { user.status = \"ignored\" }\n                  else if (user.status == 5) { user.status = \"aborted\" }\n                  else if (user.status == 6) { user.status = \"read\" }\n                  else if (user.status == 7) { user.status = \"delivered\" }\n\n                  return (\n                    <tr key={idx}>\n                      <td>\n                        <p className=\"sentmessagereport\">\n                          {user.status}\n                        </p>\n                      </td>\n                      <td className=\"trowreport\">{user.user}</td>\n                      {user?.status_message?.includes('http') ?\n                        <td className=\"trowreport\">\n                          <a href={user.status_message} rel=\"noopener noreferrer\" target=\"_blank\">\n                            Location\n                          </a>\n                        </td>\n                        :\n                        <td className=\"trowreport\">\n                          {user.status_message}\n                        </td>\n\n                      }\n                      <td className=\"trowreport\"><div>\n                        <p style={{\n                          fontSize: 12,\n                          fontFamily: 'Open Sans',\n                          letterSpacing: '0.41px',\n                          textAlign: 'right',\n                          color: 'var(--text-light)',\n                          lineHeight: 1.33\n                        }}>\n                          {new Date(user.sent_datetime).toLocaleDateString()}\n                        </p>\n\n                        <p style={{\n                          fontSize: 12,\n                          fontFamily: 'Open Sans',\n                          letterSpacing: '0.41px',\n                          textAlign: 'right',\n                          color: 'var(--text-light)',\n                          lineHeight: 1.33\n                        }}>\n                          {new Date(user.sent_datetime).toLocaleTimeString()}\n                        </p>\n                      </div></td>\n                      <td className=\"trowreport\"><div>\n                        <p style={{\n                          fontSize: 12,\n                          fontFamily: 'Open Sans',\n                          letterSpacing: '0.41px',\n                          textAlign: 'right',\n                          color: 'var(--text-light)',\n                          lineHeight: 1.33\n                        }}>\n                          {new Date(user.read_datetime).toLocaleDateString()}\n                        </p>\n\n                        <p style={{\n                          fontSize: 12,\n                          fontFamily: 'Open Sans',\n                          letterSpacing: '0.41px',\n                          textAlign: 'right',\n                          color: 'var(--text-light)',\n                          lineHeight: 1.33\n                        }}>\n                          {new Date(user.read_datetime).toLocaleTimeString()}\n                        </p>\n                      </div></td>\n                    </tr>\n                  )\n                })}\n              </tbody>\n\n            </table>\n            {report.broadcast.report.length > 1 &&\n              <>\n                <p\n                  onClick={() => getLastReportPage(page, size)}\n                >\n                  {'<'}\n                </p>\n                <p>{(page == 0 ? 1 : page) * size - 24}-{(page == 0 ? 1 : page) * size}</p>\n                <p\n                  onClick={() => getNextReportPage(page, size)}\n                >\n                  {'>'}\n                </p>\n              </>\n            }\n          </section>\n        </>\n        : 'loading'\n      }\n\n    </>\n\n  )\n}\n\nexport default Report","import Report from '../../components/message/report'\n\nexport default Report"],"sourceRoot":""}